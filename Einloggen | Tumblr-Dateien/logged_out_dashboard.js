/*! scripts/hello_lightbox_loader.js */
(function(c,a){var b=Backbone.View.extend({initialize:function(d){this.options=d||{};if(typeof this.$el=="undefined"||this.$el.length===0||this.$el.find("leviathan").length!==0){this.remove();return false}this.is_dark=this.options.dark||false;this.id_name=this.options.id_name||false;this.uid=Math.floor(Math.random()*10000);this.$el.append(this.html());this.$loader=c(".leviathan.loader_"+this.uid);if(this.is_dark){this.$loader.addClass("dark")}this.center();this.$u1=c("i.unum",this.$loader);this.$u2=c("i.duo",this.$loader);this.$u3=c("i.tres",this.$loader);this.ti=null;this.t1=null;this.t2=null;this.t3=null},start:function(){clearInterval(this.ti);var d=_.bind(function(){this.t1=this.rise(this.$u1,300,0);this.t2=this.rise(this.$u2,300,100);this.t3=this.rise(this.$u3,300,200)},this);d();this.ti=setInterval(_.bind(function(){clearTimeout(this.t1);clearTimeout(this.t2);clearTimeout(this.t3);d()},this,d),600);this.$loader.show()},stop:function(){this.$loader.hide();clearInterval(this.ti);clearTimeout(this.t1);clearTimeout(this.t2);clearTimeout(this.t3)},destroy:function(){this.stop();this.unbind();this.$loader.remove();this.remove()},center:function(){var e=this.$el.width();var d=this.$el.height();var g=this.$loader.width();var f=this.$loader.height();var i=(e/2)-(g/2);var h=(d/2)-(f/2);this.$loader.css({left:i,top:h})},rise:function(e,f,d){if(typeof e=="undefined"||e.length===0){return}return setTimeout(function(){e.stop(true,true).animate({height:"28px",opacity:1,marginTop:"0px"},f).animate({height:"20px",opacity:0.5,marginTop:"4px"},f)},d)},html:function(){var d=(this.id_name)?'id="'+this.id_name+'"':"";return"<div "+d+' class="loader_'+this.uid+' leviathan"><i class="unum"></i><i class="duo"></i><i class="tres"></i></div>'}});a.HelloLoader=b})(jQuery,Tumblr);
/*! scripts/hello_lightbox.js */
(function(c,a){var b=Backbone.View.extend({_scroll_offset:0,use_cache:true,initialize:function(d){this.options=d||{};this.lightbox_trigger=this.options.lightbox_trigger||".go, .lightbox_trigger";this.post_selector=this.options.post_selector||".ht_post";this.$post_el=this.options.post_el||this.$el.find(this.post_selector+", .lightbox_data");this.follow_source=this.options.follow_source||"FOLLOW_SOURCE_BLOG_LIGHTBOX";this.post_id=this.$post_el.data("post-id")||this.$post_el.data("id");this.post_id=parseInt(this.post_id,10);this.tumblelog=this.$post_el.data("tumblelog-name")||this.$post_el.data("tumblelog");this.$ht_post=this.$post_el||c(this.post_selector,this.el);this.$go=c(this.lightbox_trigger,this.el);this.is_visible=false;this.is_safari=(navigator.userAgent.indexOf("Safari")!=-1&&navigator.userAgent.indexOf("Chrome")==-1);this.is_oldie=(jQuery.browser.msie&&(parseInt(jQuery.browser.version,10)<=9));if(!this.post_id||!this.tumblelog){return}this.$go.on("click",this.el,_.bind(this.launch,this))},close_lightbox:function(){c("html").removeClass("lightbox_open");if(this._loader){this._loader.destroy()}this._loader=false;c("#hello_glass .leviathan").remove();c("#hello_glass").remove();this.is_visible=false;c("#logged_out_header, .logged_out_header").css("top",0);c("body").css("background-position","0px 0px");this.$ht_post.removeClass("active");window.blur();window.focus();if(typeof(this.$el.data("reset"))==="function"){this.$el.data("reset")()}c(document).off("keyup");c(window).unbind("onmessage");c(window).unbind("message");c("body").unbind("mousewheel");this.$el.trigger("lightbox_close")},iframe_from_url:function(h,d){var g="/hello_lightbox/"+encodeURIComponent(h)+"/"+d+"?follow_source="+this.follow_source;var e='<iframe id="hello_lightbox" style="visibility:hidden;display:none;" allowtransparency="true" src="'+g+'" > </iframe>';c("#hello_glass").append(e)},iframe_from_template:function(k,d){var h="";if(typeof hello_post_cache=="object"&&typeof hello_post_cache[d]=="string"&&typeof hello_tumblelog_cache[k]=="string"){header_html=hello_tumblelog_cache[k];h=hello_post_cache[d]}else{this.iframe_from_url(k,d);return}var e=window.Templates.Hello_Lightbox;e=e.replace("<!--{BLOCK:TUMBLELOG_HEADER}-->",header_html);e=e.replace("<!--{BLOCK:FEATURED_POST}-->",h);e=e.replace("<!--{BLOCK:TUMBLELOG_NAME}-->",encodeURIComponent(k));e=e.replace("<!--{BLOCK:POST_ID}-->",d);c("#hello_glass").append('<iframe id="hello_lightbox" style="visibility:hidden;display:none;" allowtransparency="true"> </iframe>');var g=c("#hello_lightbox").get(0);var j=g.contentWindow||g.documentWindow;var i=j.document;f;i.open();i.write(e);i.close()},launch:function(g){if(g.metaKey||g.shiftKey||g.ctrlKey){return true}var i=g.target||g.srcElement;var e=c(i);if(e.prop("tagName")==="A"&&e.hasClass("tag")){return g}c("body").removeClass("option");this.$ht_post.addClass("active");if(c(".load",this.$go).length===0){this.$go.append('<div class="load"></div>');this._loader=new Tumblr.HelloLoader({el:c(".load",this.$go).get(0)});this._loader.start()}if(c("#hello_glass").length>0||this.post_id<=0){return false}c("body").prepend('<div id="hello_glass" class="loading"></div>');c(document).on("keyup",_.bind(function(j){if(j.which==27){if(c("#tumblr_lightbox").length===0&&this.is_visible===false){this.close_lightbox()}}},this));var h=window.addEventListener?"addEventListener":"attachEvent";var d=h=="attachEvent"?"onmessage":"message";this._scroll_offset=window.pageYOffset;c("body").bind("mousewheel",function(){return false});if(!this.options.use_cache||window.Templates.Hello_Lightbox==null||this.is_safari||this.is_oldie){this.iframe_from_url(this.tumblelog,this.post_id)}else{this.iframe_from_template(this.tumblelog,this.post_id)}c(window).bind(d,_.bind(function(o){var q=o.originalEvent;if(q.data=="close_glass"){this.close_lightbox()}else{if(q.data=="page_ready"){c("html").addClass("lightbox_open");c("#hello_glass").removeClass("loading");c("#hello_lightbox").css("display","block").css("visibility","visible");this.is_visible=true;if(this._loader){this._loader.destroy()}this._loader=false;c("#hello_glass .leviathan").remove();c(".load",this.$go).remove();if(c("#hello_lightbox").length){c("#hello_lightbox")[0].contentWindow.blur();c("#hello_lightbox")[0].contentWindow.focus()}}else{if(q.data=="signup_account"){this.close_lightbox();if(Tumblr.RegistrationForm){Tumblr.RegistrationForm.update_view("signup_account")}}else{if(q.data.substring(0,14)=="open_lightbox/"){var m=q.data.substring(14);var k=m.split("/");var l=k[0];var p=k[1];this.is_visible=false;c("#hello_lightbox").remove();var n=c("#hello_glass");if(n.find(".leviathan").length===0){var j=new Tumblr.HelloLoader({el:n.get(0)});c("#hello_glass").data("loader",j);j.start()}this.iframe_from_url(p,l);return}}}}},this));c("#hello_glass").on("click",_.bind(function(){this.close_lightbox()},this));g.preventDefault();this.$el.trigger("lightbox_open")}});if("ab".substr(-1)!="b"){String.prototype.substr=function(d){return function(g,e){if(g<0){g=this.length+g}return d.call(this,g,e)}}(String.prototype.substr)}a.HelloLightbox=b})(jQuery,Tumblr);
/*! scripts/landing_pages/logged_out_dashboard.js */
(function(b,a){var c=Backbone.View.extend({initialize:function(){var d=b("body");var f=d.hasClass("signup_account");var e=d.hasClass("is_mobile");b(window).on("load",function(){d.removeClass("loading")});if(f&&!e){this.init_lightbox()}else{if(e){d.css("minHeight",b(document).height())}}if(Tumblr.Utils&&Tumblr.Utils.popover){Tumblr.Utils.popover.clear_session_storage("optica_header");Tumblr.Utils.popover.clear_session_storage("tumblelog_popover")}},init_lightbox:function(){this.bind_message_follow();var d=b(".fullscreen_post_posted_by .post_info");var e=new Tumblr.HelloLightbox({el:d,post_el:d,lightbox_trigger:"no_exist",follow_source:"REGISTRATION_PAGE_BACKGROUND_ATTR"});d.on("click",function(g){e.launch(g);var h=jQuery("#hello_glass"),f=new Tumblr.HelloLoader({el:h.get(0)});h.data("loader",f);f.start()}).css("cursor","pointer")},bind_message_follow:function(){b(window).bind((typeof window.addEventListener=="undefined")?"onmessage":"message",function(f){var h=f.originalEvent;if(h.data.indexOf("follow:")===0){var g=b("#signup_form").find("input[name=follow]");if(g.length==0){g=b('<input type="hidden" id="follow" name="follow" />').appendTo("#signup_form .form_row_hidden")}var d=h.data.substr(7);g.val(d);if(typeof history!="undefined"){history.replaceState(null,null,(b("body").hasClass("signup_account")?"/register":"/login")+"/follow/"+d)}}})}});a.LoggedOutDashboardB=c})(jQuery,Tumblr);